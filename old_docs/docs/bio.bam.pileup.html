<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="utf-8">
	<title>bio.bam.pileup - BioD documentation</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- styles -->
	<link href="/docs/assets/css/bootstrap.css" rel="stylesheet">
	<style type="text/css">
		body {
		padding-top: 60px;
		padding-bottom: 40px;
		}
		.sidebar-nav {
		padding: 9px 0;
		}
	</style>
	<link href="/docs/assets/css/bootstrap-responsive.css" rel="stylesheet">
	<link href="/docs/bootdoc.css" rel="stylesheet">

	<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- fav and touch icons -->
	<link rel="shortcut icon" href="/docs/assets/ico/favicon.ico">
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/docs/assets/ico/apple-touch-icon-114-precomposed.png">
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/docs/assets/ico/apple-touch-icon-72-precomposed.png">
	<link rel="apple-touch-icon-precomposed" href="/docs/assets/ico/apple-touch-icon-57-precomposed.png">
	
	<!-- Introduce DDoc settings required by JavaScript -->
	<script type="text/javascript">
		var Title = 'bio.bam.pileup';
		var SourceRepository = 'http://github.com/biod/BioD/tree/master';
		var PackageSeparator = '.';
	</script>
	
	<style type="text/css">
		.ddoc-icon-variable { background-image: url('/docs/ddoc-icons/var.png'); }
		.ddoc-icon-function { background-image: url('/docs/ddoc-icons/func.png'); }
		.ddoc-icon-property { background-image: url('/docs/ddoc-icons/property.png'); }
		.ddoc-icon-struct { background-image: url('/docs/ddoc-icons/struct.png'); }
		.ddoc-icon-class { background-image: url('/docs/ddoc-icons/class.png'); }
		.ddoc-icon-enum { background-image: url('/docs/ddoc-icons/enum.png'); }
		.ddoc-icon-template { background-image: url('/docs/ddoc-icons/template.png'); }
	</style>
	</head>

	<body>
	<!--
	JavaScript reaps the module list from this element.
	This is required for the MODULES macro to be reusable
	in a noscript element later.
	-->
	<ul id="module-list-source" class="hidden">
		
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sam.reader.html" title="bio.sam.reader"><i class="icon-th"></i>bio.sam.reader</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sam.header.html" title="bio.sam.header"><i class="icon-th"></i>bio.sam.header</a></li>
	<li class="sidebar-list-entry tree-leaf"><a href="bio.bam.reader.html" title="bio.bam.reader"><i class="icon-th"></i>bio.bam.reader</a></li>
	<li class="sidebar-list-entry tree-leaf"><a href="bio.bam.writer.html" title="bio.bam.writer"><i class="icon-th"></i>bio.bam.writer</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.read.html" title="bio.bam.read"><i class="icon-th"></i>bio.bam.read</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.tagvalue.html" title="bio.bam.tagvalue"><i class="icon-th"></i>bio.bam.tagvalue</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.reference.html" title="bio.bam.reference"><i class="icon-th"></i>bio.bam.reference</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.pileup.html" title="bio.bam.pileup"><i class="icon-th"></i>bio.bam.pileup</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.baseinfo.html" title="bio.bam.baseinfo"><i class="icon-th"></i>bio.bam.baseinfo</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.serialization.json.html" title="bio.bam.serialization.json"><i class="icon-th"></i>bio.bam.serialization.json</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.serialization.sam.html" title="bio.bam.serialization.sam"><i class="icon-th"></i>bio.bam.serialization.sam</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.md.reconstruct.html" title="bio.bam.md.reconstruct"><i class="icon-th"></i>bio.bam.md.reconstruct</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.iontorrent.flowcall.html" title="bio.bam.iontorrent.flowcall"><i class="icon-th"></i>bio.bam.iontorrent.flowcall</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.iontorrent.flowindex.html" title="bio.bam.iontorrent.flowindex"><i class="icon-th"></i>bio.bam.iontorrent.flowindex</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.baifile.html" title="bio.bam.baifile"><i class="icon-th"></i>bio.bam.baifile</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.bai.bin.html" title="bio.bam.bai.bin"><i class="icon-th"></i>bio.bam.bai.bin</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.bai.chunk.html" title="bio.bam.bai.chunk"><i class="icon-th"></i>bio.bam.bai.chunk</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.readrange.html" title="bio.bam.readrange"><i class="icon-th"></i>bio.bam.readrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.referenceinfo.html" title="bio.bam.referenceinfo"><i class="icon-th"></i>bio.bam.referenceinfo</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.reader.html" title="bio.sff.reader"><i class="icon-th"></i>bio.sff.reader</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.writer.html" title="bio.sff.writer"><i class="icon-th"></i>bio.sff.writer</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.read.html" title="bio.sff.read"><i class="icon-th"></i>bio.sff.read</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.readrange.html" title="bio.sff.readrange"><i class="icon-th"></i>bio.sff.readrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.constants.html" title="bio.sff.constants"><i class="icon-th"></i>bio.sff.constants</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.index.html" title="bio.sff.index"><i class="icon-th"></i>bio.sff.index</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.block.html" title="bio.core.bgzf.block"><i class="icon-th"></i>bio.core.bgzf.block</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.blockrange.html" title="bio.core.bgzf.blockrange"><i class="icon-th"></i>bio.core.bgzf.blockrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.compress.html" title="bio.core.bgzf.compress"><i class="icon-th"></i>bio.core.bgzf.compress</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.constants.html" title="bio.core.bgzf.constants"><i class="icon-th"></i>bio.core.bgzf.constants</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.virtualoffset.html" title="bio.core.bgzf.virtualoffset"><i class="icon-th"></i>bio.core.bgzf.virtualoffset</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.inputstream.html" title="bio.core.bgzf.inputstream"><i class="icon-th"></i>bio.core.bgzf.inputstream</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.outputstream.html" title="bio.core.bgzf.outputstream"><i class="icon-th"></i>bio.core.bgzf.outputstream</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.base.html" title="bio.core.base"><i class="icon-th"></i>bio.core.base</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.region.html" title="bio.core.region"><i class="icon-th"></i>bio.core.region</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.sequence.html" title="bio.core.sequence"><i class="icon-th"></i>bio.core.sequence</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.tinymap.html" title="bio.core.tinymap"><i class="icon-th"></i>bio.core.tinymap</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.fasta.html" title="bio.core.fasta"><i class="icon-th"></i>bio.core.fasta</a></li>
	</ul>
	
	<div class="navbar navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container-fluid">
				<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</a>
				<a class="brand" href="/docs/index.html">BioD</a>
				<div class="nav-collapse">
					<ul class="nav">
						<li class="active"><a href="/docs/index.html">Reference</a></li>
					</ul>
					
					<form id="gotosymbol" class="navbar-search pull-left hidden">
						<input type="text" class="search-query" placeholder="Go to symbol in bio.bam.pileup" data-provide="typeahead" data-items="4">
					</form>
					
					<p class="navbar-text pull-right"><a href="https://github.com/biod/BioD">Github Page</a></p>
				</div><!--/.nav-collapse -->
			</div>
		</div>
	</div>

	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span2">
				<div class="well sidebar-nav">
				<ul class="nav nav-list">
					<li id="module-list" class="nav-header sidebar-list-entry">Modules<li>
					<noscript>
						
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sam.reader.html" title="bio.sam.reader"><i class="icon-th"></i>bio.sam.reader</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sam.header.html" title="bio.sam.header"><i class="icon-th"></i>bio.sam.header</a></li>
	<li class="sidebar-list-entry tree-leaf"><a href="bio.bam.reader.html" title="bio.bam.reader"><i class="icon-th"></i>bio.bam.reader</a></li>
	<li class="sidebar-list-entry tree-leaf"><a href="bio.bam.writer.html" title="bio.bam.writer"><i class="icon-th"></i>bio.bam.writer</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.read.html" title="bio.bam.read"><i class="icon-th"></i>bio.bam.read</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.tagvalue.html" title="bio.bam.tagvalue"><i class="icon-th"></i>bio.bam.tagvalue</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.reference.html" title="bio.bam.reference"><i class="icon-th"></i>bio.bam.reference</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.pileup.html" title="bio.bam.pileup"><i class="icon-th"></i>bio.bam.pileup</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.baseinfo.html" title="bio.bam.baseinfo"><i class="icon-th"></i>bio.bam.baseinfo</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.serialization.json.html" title="bio.bam.serialization.json"><i class="icon-th"></i>bio.bam.serialization.json</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.serialization.sam.html" title="bio.bam.serialization.sam"><i class="icon-th"></i>bio.bam.serialization.sam</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.md.reconstruct.html" title="bio.bam.md.reconstruct"><i class="icon-th"></i>bio.bam.md.reconstruct</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.iontorrent.flowcall.html" title="bio.bam.iontorrent.flowcall"><i class="icon-th"></i>bio.bam.iontorrent.flowcall</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.iontorrent.flowindex.html" title="bio.bam.iontorrent.flowindex"><i class="icon-th"></i>bio.bam.iontorrent.flowindex</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.baifile.html" title="bio.bam.baifile"><i class="icon-th"></i>bio.bam.baifile</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.bai.bin.html" title="bio.bam.bai.bin"><i class="icon-th"></i>bio.bam.bai.bin</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.bai.chunk.html" title="bio.bam.bai.chunk"><i class="icon-th"></i>bio.bam.bai.chunk</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.readrange.html" title="bio.bam.readrange"><i class="icon-th"></i>bio.bam.readrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.bam.referenceinfo.html" title="bio.bam.referenceinfo"><i class="icon-th"></i>bio.bam.referenceinfo</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.reader.html" title="bio.sff.reader"><i class="icon-th"></i>bio.sff.reader</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.writer.html" title="bio.sff.writer"><i class="icon-th"></i>bio.sff.writer</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.read.html" title="bio.sff.read"><i class="icon-th"></i>bio.sff.read</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.readrange.html" title="bio.sff.readrange"><i class="icon-th"></i>bio.sff.readrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.constants.html" title="bio.sff.constants"><i class="icon-th"></i>bio.sff.constants</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.sff.index.html" title="bio.sff.index"><i class="icon-th"></i>bio.sff.index</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.block.html" title="bio.core.bgzf.block"><i class="icon-th"></i>bio.core.bgzf.block</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.blockrange.html" title="bio.core.bgzf.blockrange"><i class="icon-th"></i>bio.core.bgzf.blockrange</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.compress.html" title="bio.core.bgzf.compress"><i class="icon-th"></i>bio.core.bgzf.compress</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.constants.html" title="bio.core.bgzf.constants"><i class="icon-th"></i>bio.core.bgzf.constants</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.virtualoffset.html" title="bio.core.bgzf.virtualoffset"><i class="icon-th"></i>bio.core.bgzf.virtualoffset</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.inputstream.html" title="bio.core.bgzf.inputstream"><i class="icon-th"></i>bio.core.bgzf.inputstream</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.bgzf.outputstream.html" title="bio.core.bgzf.outputstream"><i class="icon-th"></i>bio.core.bgzf.outputstream</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.base.html" title="bio.core.base"><i class="icon-th"></i>bio.core.base</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.region.html" title="bio.core.region"><i class="icon-th"></i>bio.core.region</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.sequence.html" title="bio.core.sequence"><i class="icon-th"></i>bio.core.sequence</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.tinymap.html" title="bio.core.tinymap"><i class="icon-th"></i>bio.core.tinymap</a></li>
    <li class="sidebar-list-entry tree-leaf"><a href="bio.core.fasta.html" title="bio.core.fasta"><i class="icon-th"></i>bio.core.fasta</a></li>
					</noscript>
					<li id="symbol-list" class="nav-header sidebar-list-entry hidden">bio.bam.pileup</li>
				</ul>
				</div><!--/.well -->
			</div><!--/span-->
			
			<div class="span10">
				<div class="row-fluid">
					<div class="span11">
						<ul id="module-breadcrumb" class="breadcrumb">
							<noscript><h1>bio.bam.pileup</h1></noscript>
						</ul>
						
					</div>
					<div class="span1 offset11">
						<a href="/docs/index.html"><img src="/docs/assets/img/icon-github.png" alt="BioD"/></a>
					</div>
				</div>
				<div id="declaration-list">
					<!-- Generated by Ddoc from /home/lomereiter/github/BioD//bio/bam/pileup.d -->
<dl><p><p>This module is used for iterating over columns of alignment.</p>
 <p>The function makePileup is called on 
 a range of coordinate-sorted reads mapped to the same reference.
 It returns an input range of columns.</p>
 <p>This returned range can then be iterated with <span class="inlinecode">foreach</span>.
 First column is located at the same position on the reference,
 as the first base of the first read.
 <br>
 Each <span class="inlinecode">popFront</span> operation advances current position on the
 reference. Currently, there's no option to skip non-covered regions.</p>
 <p>Each column keeps set of reads that overlap corresponding position
 on the reference.
 If reads contain MD tags, and makePileup was asked
 to use them, reference base at the column is also available.</p>
 <br>
 Each read preserves all standard read properties 
 but also keeps column-related information, namely
 <ul>
     <li>number of bases consumed from the read sequence so far</li>
     <li>current CIGAR operation and offset in it</li>
     <li>all CIGAR operations before and after current one</li></ul>
 <br>
 It is clear from the above that current CIGAR operation cannot be an insertion.
 The following are suggested ways to check for them:
 <ul>
     <li><span class="inlinecode">cigar_after.length &gt; 0 &amp;&amp;
              cigar_operation_offset == cigar_operation.length - 1 &amp;&amp;
              cigar_after[0].type == 'I'</span></li>
     <li><span class="inlinecode">cigar_before.length &gt; 0 &amp;&amp;
              cigar_operation_offset == 0 &amp;&amp;
              cigar_before[$ - 1].type == 'I'</span></li></ul>
 <br>
</p>
<dt>Example:</dt><dd>
<pre class="d_code"> <span class="d_keyword">import</span> bio.bam.reader, bio.bam.<u>pileup</u>, std.stdio, std.algorithm : count;
 <span class="d_keyword">void</span> main() {
     <span class="d_keyword">auto</span> bam = <span class="d_keyword">new</span> BamReader(<span class="d_string">"file.bam"</span>);       <span class="d_comment">// assume single reference and MD tags
</span>     <span class="d_keyword">auto</span> <u>pileup</u> = bam.reads().makePileup(<span class="d_keyword">true</span>); <span class="d_comment">// use MD tags
</span>     <span class="d_keyword">foreach</span> (column; <u>pileup</u>) {
         <span class="d_keyword">auto</span> matches = column.bases.count(column.reference_base);
         <span class="d_keyword">if</span> (matches &lt; column.coverage * 2 / 3)
             writeln(column.position);           <span class="d_comment">// print positions of possible mismatches
</span>     }
 }
</pre>
</dd>
</dl>
<hr><div class="row-fluid declaration"><h3>struct <span class="symbol-target" id="PileupRead">&nbsp;</span><a class="symbol-link" href="#PileupRead">PileupRead</a>(Read = bio.bam.read.EagerBamRead);
</h3></div>
<div class="declaration-content"><dl><p>Represents a read aligned to a column</p>
</dl>
<div class="offset1 member-list"><hr><div class="row-fluid declaration"><h3>Read <span class="symbol-target" id="read">&nbsp;</span><a class="symbol-link" href="#read">read</a>;
</h3></div>
<div class="declaration-content"><br><br>
</div>
<hr><div class="row-fluid declaration"><h3>const @property bio.bam.read.CigarOperation <span class="symbol-target" id="cigar_operation">&nbsp;</span><a class="symbol-link" href="#cigar_operation">cigar_operation</a>();
</h3></div>
<div class="declaration-content"><dl><p>Current CIGAR operation. One of 'M', '=', 'X', 'D', 'N.
 Use <span class="inlinecode">cigar_after</span>/<span class="inlinecode">cigar_before</span> to determine insertions.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property uint <span class="symbol-target" id="cigar_operation_offset">&nbsp;</span><a class="symbol-link" href="#cigar_operation_offset">cigar_operation_offset</a>();
</h3></div>
<div class="declaration-content"><dl><p>Number of bases consumed from the current CIGAR operation.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property const(bio.bam.read.CigarOperation)[] <span class="symbol-target" id="cigar_after">&nbsp;</span><a class="symbol-link" href="#cigar_after">cigar_after</a>();
</h3></div>
<div class="declaration-content"><dl><p>CIGAR operations after the current operation</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property const(bio.bam.read.CigarOperation)[] <span class="symbol-target" id="cigar_before">&nbsp;</span><a class="symbol-link" href="#cigar_before">cigar_before</a>();
</h3></div>
<div class="declaration-content"><dl><p>CIGAR operations before the current operation</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property char <span class="symbol-target" id="current_base">&nbsp;</span><a class="symbol-link" href="#current_base">current_base</a>();
</h3></div>
<div class="declaration-content"><dl><p>If current CIGAR operation is one of 'M', '=', or 'X', returns read base
 at the current column. Otherwise, returns '-'.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property ubyte <span class="symbol-target" id="current_base_quality">&nbsp;</span><a class="symbol-link" href="#current_base_quality">current_base_quality</a>();
</h3></div>
<div class="declaration-content"><dl><p>If current CIGAR operation is one of 'M', '=', or 'X', returns
 Phred-scaled read base quality at the current column.
 Otherwise, returns 255.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property int <span class="symbol-target" id="query_offset">&nbsp;</span><a class="symbol-link" href="#query_offset">query_offset</a>();
</h3></div>
<div class="declaration-content"><dl><p>Returns number of bases consumed from the read sequence.
 <br>
 More concisely,
 <ul>    <li>if current CIGAR operation is 'M', '=', or 'X',
       index of current read base in the read sequence</li>
     <li>if current CIGAR operation is 'D' or 'N',
       index of read base after the deletion</li>
 </ul>
 (in both cases indices are 0-based)</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property PileupRead <span class="symbol-target" id="dup">&nbsp;</span><a class="symbol-link" href="#dup">dup</a>();
</h3></div>
<div class="declaration-content"><dl><p>Returns duplicate</p>
</dl>
</div>
</div>
</div>
<hr><div class="row-fluid declaration"><h3>struct <span class="symbol-target" id="PileupColumn">&nbsp;</span><a class="symbol-link" href="#PileupColumn">PileupColumn</a>(R);
</h3></div>
<div class="declaration-content"><dl><p>Represents a single pileup column</p>
</dl>
<div class="offset1 member-list"><hr><div class="row-fluid declaration"><h3>const @property char <span class="symbol-target" id="reference_base">&nbsp;</span><a class="symbol-link" href="#reference_base">reference_base</a>();
</h3></div>
<div class="declaration-content"><dl><p>Reference base. 'N' if not available.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property size_t <span class="symbol-target" id="coverage">&nbsp;</span><a class="symbol-link" href="#coverage">coverage</a>();
</h3></div>
<div class="declaration-content"><dl><p>Coverage at this position (equals to number of reads)</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property int <span class="symbol-target" id="ref_id">&nbsp;</span><a class="symbol-link" href="#ref_id">ref_id</a>();
</h3></div>
<div class="declaration-content"><dl><p>Returns reference ID (-1 if unmapped)</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property ulong <span class="symbol-target" id="position">&nbsp;</span><a class="symbol-link" href="#position">position</a>();
</h3></div>
<div class="declaration-content"><dl><p>Position on the reference</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property auto <span class="symbol-target" id="reads">&nbsp;</span><a class="symbol-link" href="#reads">reads</a>();
</h3></div>
<div class="declaration-content"><dl><p>Reads overlapping the position, sorted by coordinate</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property auto <span class="symbol-target" id="reads_starting_here">&nbsp;</span><a class="symbol-link" href="#reads_starting_here">reads_starting_here</a>();
</h3></div>
<div class="declaration-content"><dl><p>Reads that have leftmost mapped position at this column</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property auto <span class="symbol-target" id="bases">&nbsp;</span><a class="symbol-link" href="#bases">bases</a>();
</h3></div>
<div class="declaration-content"><dl><p>Shortcut for map!(read =&gt; read.current_base)(reads)</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property auto <span class="symbol-target" id="base_qualities">&nbsp;</span><a class="symbol-link" href="#base_qualities">base_qualities</a>();
</h3></div>
<div class="declaration-content"><dl><p>Shortcut for map!(read =&gt; read.current_base_quality)(reads)</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property auto <span class="symbol-target" id="read_qualities">&nbsp;</span><a class="symbol-link" href="#read_qualities">read_qualities</a>();
</h3></div>
<div class="declaration-content"><dl><p>Shortcut for map!(read =&gt; read.mapping_quality)(reads)</p>
</dl>
</div>
</div>
</div>
<hr><div class="row-fluid declaration"><h3>class <span class="symbol-target" id="PileupRange">&nbsp;</span><a class="symbol-link" href="#PileupRange">PileupRange</a>(R, alias TColumn = PileupColumn);
</h3></div>
<div class="declaration-content"><dl><p>The class for iterating reference bases together with reads overlapping them.</p>
</dl>
<div class="offset1 member-list"><hr><div class="row-fluid declaration"><h3> this(R <i>reads</i>);
</h3></div>
<div class="declaration-content"><dl><p>Create new pileup iterator from a range of <i>reads</i>.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property Column <span class="symbol-target" id="front">&nbsp;</span><a class="symbol-link" href="#front">front</a>();
</h3></div>
<div class="declaration-content"><dl><p>Returns PileupColumn struct corresponding to the current position.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>@property bool <span class="symbol-target" id="empty">&nbsp;</span><a class="symbol-link" href="#empty">empty</a>();
</h3></div>
<div class="declaration-content"><dl><p>Whether all reads have been processed.</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>void <span class="symbol-target" id="popFront">&nbsp;</span><a class="symbol-link" href="#popFront">popFront</a>();
</h3></div>
<div class="declaration-content"><dl><p>Move to next position on the reference.</p>
</dl>
</div>
</div>
</div>
<hr><div class="row-fluid declaration"><h3>struct <span class="symbol-target" id="AbstractPileup">&nbsp;</span><a class="symbol-link" href="#AbstractPileup">AbstractPileup</a>(S);
</h3></div>
<div class="declaration-content"><dl><p>Abstract pileup structure. S is type of column range.</p>
</dl>
<div class="offset1 member-list"><hr><div class="row-fluid declaration"><h3>const @property ulong <span class="symbol-target" id="start_position">&nbsp;</span><a class="symbol-link" href="#start_position">start_position</a>();
</h3></div>
<div class="declaration-content"><dl><p><span class="inlinecode">start_from</span> parameter provided to a pileup function</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property ulong <span class="symbol-target" id="end_position">&nbsp;</span><a class="symbol-link" href="#end_position">end_position</a>();
</h3></div>
<div class="declaration-content"><dl><p><span class="inlinecode">end_at</span> parameter provided to a pileup function</p>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>const @property int <span class="symbol-target" id="ref_id">&nbsp;</span><a class="symbol-link" href="#ref_id">ref_id</a>();
</h3></div>
<div class="declaration-content"><dl><p>Reference ID of all reads in this pileup.</p>
</dl>
</div>
</div>
</div>
<hr><div class="row-fluid declaration"><h3>class <span class="symbol-target" id="PileupRangeUsingMdTag">&nbsp;</span><a class="symbol-link" href="#PileupRangeUsingMdTag">PileupRangeUsingMdTag</a>(R): PileupRange!(R, PileupColumn);
</h3></div>
<div class="declaration-content"><dl><p>Tracks current reference base</p>
</dl>
<div class="offset1 member-list"><hr><div class="row-fluid declaration"><h3> this(R <i>reads</i>);
</h3></div>
<div class="declaration-content"><br><br>
</div>
<hr><div class="row-fluid declaration"><h3>void <span class="symbol-target" id="popFront">&nbsp;</span><a class="symbol-link" href="#popFront">popFront</a>();
</h3></div>
<div class="declaration-content"><br><br>
</div>
</div>
</div>
<hr><div class="row-fluid declaration"><h3>auto <span class="symbol-target" id="makePileup">&nbsp;</span><a class="symbol-link" href="#makePileup">makePileup</a>(R)(R <i>reads</i>, bool <i>use_md_tag</i> = false, ulong <i>start_from</i> = 0, ulong <i>end_at</i> = (ulong).max);
</h3></div>
<div class="declaration-content"><dl><p>Creates a pileup range from a range of reads.
 Note that all reads must be aligned to the same reference.
</p>
<p>See <span class="inlinecode">PileupColumn</span> documentation for description of range elements.
 Note also that you can't use <span class="inlinecode">std.array.array()</span> function on pileup
 because it won't make deep copies of underlying data structure.
 (One might argue that in this case it would be better to use opApply,
 but typically one would use <span class="inlinecode">std.algorithm.map</span> on pileup columns
 to obtain some numeric characteristics.)
 
</p>
<dt>Parameters</dt><dd><table class="table table-condensed table-bordered"><tr><td>use_md_tag</td>
<td>if <span class="d_keyword">true</span>, use MD tag together with CIGAR
                   to recover reference bases</td></tr>
<tr><td>start_from</td>
<td>position from which to start</td></tr>
<tr><td>end_at</td>
<td>position before which to stop
<br><br>

 <br>
 That is, the range of positions is half-open interval 
 <br>
 [max(start_from, first mapped read start position), 
 <br>
  min(end_at, last mapped end position among all reads))</td></tr>
</table></dd>
</dl>
</div>
<hr><div class="row-fluid declaration"><h3>auto <span class="symbol-target" id="pileupChunks">&nbsp;</span><a class="symbol-link" href="#pileupChunks">pileupChunks</a>(R)(R <i>reads</i>, bool <i>use_md_tag</i> = false, size_t <i>block_size</i> = 16384000, ulong <i>start_from</i> = 0, ulong <i>end_at</i> = (ulong).max);
</h3></div>
<div class="declaration-content"><dl><p>This function constructs range of non-overlapping consecutive pileups from a range of reads
 so that these pileups can be processed in parallel.
 
 It's allowed to pass ranges of sorted reads with different ref. IDs,
 they won't get mixed in any chunk.
 
</p>
<dt>Parameters</dt><dd><table class="table table-condensed table-bordered"><tr><td>use_md_tag</td>
<td>recover reference bases from MD tag and CIGAR</td></tr>
<tr><td>block_size</td>
<td>approximate amount of memory that each pileup will consume,
                  given in bytes. (Usually consumption will be a bit higher.)</td></tr>
<tr><td>start_from</td>
<td>position of the first column of the first chunk</td></tr>
<tr><td>end_at</td>
<td>position after the last column of the last chunk
<br><br>

 <br></td></tr>
</table></dd>
<dt>WARNING:</dt><dd>
block size should be big enough so that every block will share
              some reads only with adjacent blocks. 
              <br>
              As such, it is not recommended to reduce the <i>block_size</i>.
              But there might be a need to increase it in case of very high coverage.</dd>
</dl>
</div>


				</div>
				
				<hr>
				
				<footer class="pull-left">
					<p>Page generated with <a href="https://github.com/JakobOvrum/bootDoc">bootDoc</a>.</p>
				</footer>
				
				<footer class="pull-right">
					<p>&copy; Artem Tarasov 2012-2013</p>
				</footer>
			</div>
		</div>
	</div><!--/.fluid-container-->

	<!-- Bootstrap javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="/docs/assets/js/jquery.min.js"></script>
	<script src="/docs/assets/js/bootstrap.min.js"></script>
	
	<!-- bootDoc javascript
	================================================== -->
	<script src="/docs/bootdoc.js"></script>
	
	</body>
</html>
